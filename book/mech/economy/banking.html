<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Banking - AirshipCraft Documentation</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/pagetoc.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../index.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="../../CHANGELOG.html">Changelog</a></li><li class="chapter-item expanded affix "><li class="part-title">Mechanics</li><li class="chapter-item expanded "><a href="../../mech/economy.html"><strong aria-hidden="true">1.</strong> Economy</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../mech/economy/market.html"><strong aria-hidden="true">1.1.</strong> Market</a></li><li class="chapter-item expanded "><a href="../../mech/economy/spreadsheet.html"><strong aria-hidden="true">1.2.</strong> Spreadsheet</a></li><li class="chapter-item expanded "><a href="../../mech/economy/banking.html" class="active"><strong aria-hidden="true">1.3.</strong> Banking</a></li><li class="chapter-item expanded "><a href="../../mech/economy/companies.html"><strong aria-hidden="true">1.4.</strong> Companies</a></li><li class="chapter-item expanded "><a href="../../mech/economy/resources.html"><strong aria-hidden="true">1.5.</strong> Resources</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../mech/economy/resources/crops.html"><strong aria-hidden="true">1.5.1.</strong> Crops</a></li><li class="chapter-item expanded "><a href="../../mech/economy/resources/hiddenore.html"><strong aria-hidden="true">1.5.2.</strong> HiddenOre</a></li></ol></li><li class="chapter-item expanded "><a href="../../mech/economy/API.html"><strong aria-hidden="true">1.6.</strong> API</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../mech/economy/api/hierarchy.html"><strong aria-hidden="true">1.6.1.</strong> Class Hierarchy</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../mech/npc.html"><strong aria-hidden="true">2.</strong> NPCs</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">2.1.</strong> Types</div></li></ol></li><li class="chapter-item expanded "><a href="../../mech/combat.html"><strong aria-hidden="true">3.</strong> Combat</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../mech/combat/movecraft.html"><strong aria-hidden="true">3.1.</strong> Movecraft</a></li><li class="chapter-item expanded "><a href="../../mech/combat/damagelistener.html"><strong aria-hidden="true">3.2.</strong> DamageListener</a></li><li class="chapter-item expanded "><a href="../../mech/combat/weapons.html"><strong aria-hidden="true">3.3.</strong> Artifacts</a></li></ol></li><li class="chapter-item expanded "><a href="../../mech/skills.html"><strong aria-hidden="true">4.</strong> Skills</a></li><li class="chapter-item expanded "><a href="../../mech/cults.html"><strong aria-hidden="true">5.</strong> Cults</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../mech/cults/objects.html"><strong aria-hidden="true">5.1.</strong> Objects</a></li><li class="chapter-item expanded "><a href="../../mech/cults/config.html"><strong aria-hidden="true">5.2.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="../../mech/cults/altars.html"><strong aria-hidden="true">5.3.</strong> Altars</a></li><li class="chapter-item expanded "><a href="../../mech/cults/shrines.html"><strong aria-hidden="true">5.4.</strong> Shrines</a></li><li class="chapter-item expanded "><a href="../../mech/cults/transmutations.html"><strong aria-hidden="true">5.5.</strong> Transmutations</a></li></ol></li><li class="chapter-item expanded "><a href="../../mech/nodes.html"><strong aria-hidden="true">6.</strong> Nodes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../mech/nodes/territories.html"><strong aria-hidden="true">6.1.</strong> Territories</a></li><li class="chapter-item expanded "><a href="../../mech/nodes/handles-over-ids.html"><strong aria-hidden="true">6.2.</strong> Prefer Handles over IDs</a></li><li class="chapter-item expanded "><a href="../../mech/nodes/nation-system.html"><strong aria-hidden="true">6.3.</strong> Nation System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../mech/nodes/nations/objects.html"><strong aria-hidden="true">6.3.1.</strong> Objects</a></li><li class="chapter-item expanded "><a href="../../mech/nodes/nations/permissions.html"><strong aria-hidden="true">6.3.2.</strong> Permissions</a></li></ol></li><li class="chapter-item expanded "><a href="../../mech/nodes/npc-integration.html"><strong aria-hidden="true">6.4.</strong> NPC Integration</a></li></ol></li><li class="chapter-item expanded "><a href="../../mech/quests.html"><strong aria-hidden="true">7.</strong> Quests</a></li><li class="chapter-item expanded affix "><li class="part-title">Map</li><li class="chapter-item expanded "><a href="../../map/regions.html"><strong aria-hidden="true">8.</strong> Regions</a></li><li class="chapter-item expanded "><a href="../../map/cities.html"><strong aria-hidden="true">9.</strong> City States</a></li><li class="chapter-item expanded "><a href="../../map/mapoverview.html"><strong aria-hidden="true">10.</strong> Map Overview</a></li><li class="chapter-item expanded affix "><li class="part-title">Core</li><li class="chapter-item expanded "><a href="../../core/common-lib.html"><strong aria-hidden="true">11.</strong> ACCommonLib</a></li><li class="chapter-item expanded "><a href="../../core/datum.html"><strong aria-hidden="true">12.</strong> Datum</a></li><li class="chapter-item expanded affix "><li class="part-title">General Development</li><li class="chapter-item expanded "><a href="../../administration/housekeeping.html"><strong aria-hidden="true">13.</strong> Housekeeping</a></li><li class="chapter-item expanded "><a href="../../administration/optimization.html"><strong aria-hidden="true">14.</strong> Optimization</a></li><li class="chapter-item expanded "><a href="../../administration/coding-standard.html"><strong aria-hidden="true">15.</strong> Coding Standard</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../administration/commits.html"><strong aria-hidden="true">15.1.</strong> Proper Git Commits</a></li></ol></li><li class="chapter-item expanded "><a href="../../administration/project-timeline.html"><strong aria-hidden="true">16.</strong> Project Timeline</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../administration/timeline/phase-1.html"><strong aria-hidden="true">16.1.</strong> Phase 1</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Misc</li><li class="chapter-item expanded "><a href="../../misc/lore.html"><strong aria-hidden="true">17.</strong> Lore</a></li><li class="chapter-item expanded affix "><a href="../../misc/contributions.html">Contributions</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">AirshipCraft Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <blockquote>
<p><span style="color:red">Currently unimplemented.</span></p>
</blockquote>
<h1 id="banking"><a class="header" href="#banking">Banking</a></h1>
<p>Banking goes hand in hand with the <code>Market</code> system as it provides a method for storing players money. We already know from the class <a href="api/hierarchy.html">hierarchy</a> that there exists player and non player accounts, but this banking system turns them into physical locations and not just hidden away as text in some database.</p>
<h2 id="what-are-banks"><a class="header" href="#what-are-banks">What Are Banks?</a></h2>
<p>A bank is a financial institution licensed to receive deposits and make loans. There are several types of banks including retail, commercial, and investment banks. In most countries, banks are regulated by the national government or central bank.</p>
<p>The goal is to try and emulate this in game as well. Allowing for <a href="../nodes/nation-system.html">nations</a> to create their own physical national banks tied directly to their economies, as well as providing the more established NPC nations their own banks as well that can give out loans and financially back and assist the player as a way for them to store their money there until their own nation becomes financially stable.</p>
<h2 id="bank-vaults"><a class="header" href="#bank-vaults">Bank Vaults</a></h2>
<p>The main feature of banks is obviously their money storing capability and this is done through <code>Vaults</code>. Vaults are physical chests that players have inside the bank.</p>
<p>Bank vaults are registered with a chest with a sign placed upon it that reads &quot;[Vault]&quot;. Upon right-clicking the sign, it will update to display the name of the player registered to that vault such as this:</p>
<p><img src="../../images/vault_sign.png" alt="Vault sign example" /></p>
<p>Vaults can also be registered to other players by typing their names on the second line instead of leaving it blank.</p>
<p>Nations and settlements also require a vault in-order to store incoming taxes from <a href="/mech/economy/market.html#taxed-transaction">taxed transactions</a> as well as a way for settlements/nations to pay upkeep in-order to keep their claims from dissolving due to inactivity. To make a vault for a nation, the setup is very similar except the name of the settlement/nation must be printed on the second line.</p>
<p>Finally, <a href="companies.html">Companies</a> can also register their own vaults in-order to store profits prior to payday, a source of money in-order to pay off dividends, and as a sort-of shared bank account between trusted employees. To register a company vault, the setup is the same: Place a sign with [Vault] on the first line, the name of the company on the second line, and INC on the third line. </p>
<h3 id="bank-vaults-and-balance"><a class="header" href="#bank-vaults-and-balance">Bank Vaults and Balance</a></h3>
<p>On most servers, a player can execute a command such as <code>/bal</code> or <code>/balance</code> in-order to view how much in-game currency they have. Since we already know that currency will be a physical item (<em>See</em>: <a href="market.html">Market</a>), it will be hard (and very unwise) for players to carry all of their money in their inventory at all times.</p>
<p>Since bank vaults act as storage for a player's money they should also have some practicality outside of that by displaying the player's combined balance of both the currency in their posession and currency stored elsewhere.</p>
<p>An example of how this would look like in-game:</p>
<pre><code>* player1 executed server command: /balance *

Chat: 

[Balance] {inventory amount, I}
[Vault Balance] {stored vault amount, V}
[Total] {total balance, I + V}
</code></pre>
<p>We can look at <a href="https://github.com/nikosgram/gringotts/blob/master/src/main/java/org/gestern/gringotts/GringottsAccount.java">Gringotts</a> for an example of how they did it:</p>
<pre><code class="language-java">/**
     * Current balance of this account in cents
     *
     * @return current balance of this account in cents
     */
    public long getBalance() {
        CompletableFuture&lt;Long&gt; cents     = getCents();
        CompletableFuture&lt;Long&gt; playerInv = countPlayerInventory();
        CompletableFuture&lt;Long&gt; chestInv  = countChestInventories();

        // order of combination is important, because chestInv/playerInv might have to run on main thread
        CompletableFuture&lt;Long&gt; f = chestInv
                .thenCombine(playerInv, Long::sum)
                .thenCombine(cents, Long::sum);

        return getTimeout(f);
    }

    /**
     * Current balance this account has in chest(s) in cents
     *
     * @return current balance this account has in chest(s) in cents
     */
    public long getVaultBalance() {
        return getTimeout(countChestInventories());
    }

    ...

    private CompletableFuture&lt;Long&gt; countChestInventories() {
        Callable&lt;Long&gt; callMe = () -&gt; {
            Collection&lt;AccountChest&gt; chests  = dao.retrieveChests(this);
            long                     balance = 0;
            
            for (AccountChest chest : chests) {
                balance += chest.balance();
            }

            Optional&lt;Player&gt; playerOpt = playerOwner();
            if (playerOpt.isPresent()) {
                Player player = playerOpt.get();

                if (Configuration.CONF.useVaultEnderChest &amp;&amp; Permissions.USE_VAULT_ENDERCHEST.isAllowed(player)) {
                    balance += new AccountInventory(player.getEnderChest()).balance();
                }
            }
            return balance;
        };

        return callSync(callMe);
    }
</code></pre>
<h2 id="banks-location"><a class="header" href="#banks-location">Banks (Location)</a></h2>
<p>This system also introduces a chunk plot called a <code>Bank</code> (can also be referred to as <code>Bank Plot</code> or <code>Bank Chunk</code>). Banks are registered when a <code>Nation Vault</code> is registered properly within the claims of that nation's capital.</p>
<p>This plot of land is special as it allows for nation leaders as well as those with the <code>Banker</code> <a href="../nodes/nations/permissions.html">permission</a> to do things such as give out loans to a player.</p>
<h3 id="loans"><a class="header" href="#loans">Loans</a></h3>
<p>Loan interest rate is configurable on a per town basis. Interest is compounded weekly.</p>
<p>In-order for a bank to give a loan, the bank must have that much money stored in a vault in-order to give it out. Once it is given out, the player who receives the loan will have that money transferred to their balance. After the due date for the loan is reached, whatever money in that player's physical vault with that bank will automatically go into paying for their debt.</p>
<p>If they were to have insufficient funds then that specific vault will have a negative balance and it will be reflected on their total balance. Players can choose simply not to pay back their loan but will still accrue interest until a <code>Banker</code> decides to &quot;forgive&quot; the loan.</p>
<p>Failure to pay off loans in a timely manner will decrease the player's <code>credit score</code> which will be viewable to anyone with the <code>Banker</code> permissions. </p>
<h3 id="minting-currencies"><a class="header" href="#minting-currencies">Minting Currencies</a></h3>
<blockquote>
<p>📝 <strong>Note:</strong> This section discusses allowing nations to mint their own currencies which can be exchanged following a global, &quot;dynamic&quot; exchange rate. This is a very complex mechanic and might be hard to implement so it might not be implemented or at least not fully implemented. HUGE WORK IN PROGRESS. Probably should just ignore this section until it gets more fleshed out.</p>
</blockquote>
<p>Banks are also used as a means to mint currencies. This option will only be available to large nations (size is configurable) as a way to keep the economy from getting too chaotic.</p>
<h4 id="requirements-to-mint-currency"><a class="header" href="#requirements-to-mint-currency"><strong>Requirements to Mint Currency</strong></a></h4>
<p>There are a few requirements in-order for nations to mint their own currencies. </p>
<ol>
<li>Firstly is the size requirement as mentioned earlier; nations must be over a specific (configurable) size in-order to mint their own currency. </li>
<li>Secondly is having <code>gold</code> in the bank. This includes ingots as well as nuggets. Currencies must be backed by gold in the bank in-order to be valid. This allows for currencies to be exchanged. </li>
</ol>
<p>When the prerequisites are met, nation leaders will able to run a command to register their currency with a name (string) and symbol (char). Once successfully created, the currency will be registered to the global economy. All currencies are backed by the value of the item <code>gold</code>. Exchange rates between different currencies will be generated based on a few factors which we will cover later.</p>
<p>Market stalls in <em>any</em> town/nation can be configured to accept any currency they choose that is registered globally. They can also choose to not accept certain currencies at any time of their choosing.</p>
<h4 id="exchange-rates"><a class="header" href="#exchange-rates"><strong>Exchange Rates</strong></a></h4>
<p>Currency exchanges between different types of currencies is handled by the bank. When depositing currency to a bank, the bank automatically converts it into the gold equivalent. If a foreign currency is deposited, then that gold is taken out of the original nation's bank into the new one. For example:<br />
// todo: i ran into some problems when trying to design a thought experiment </p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../mech/economy/spreadsheet.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../mech/economy/companies.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../mech/economy/spreadsheet.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../mech/economy/companies.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../theme/pagetoc.js"></script>


    </body>
</html>
